# Development Dockerfile for API with hot reload
FROM node:18-alpine AS development
WORKDIR /app

# Install dependencies for nodemon and development
COPY package*.json ./
COPY apps/api/package*.json ./apps/api/
COPY packages ./packages

# Install all dependencies (including dev)
# Using install instead of ci since we're in a monorepo and may not have all lock files
RUN npm install --workspace=api

# Copy API source files
WORKDIR /app/apps/api
COPY apps/api/ ./

# Expose API and debug ports
EXPOSE 3010 9229

# Start with nodemon for hot reload
CMD ["npm", "run", "dev"]
